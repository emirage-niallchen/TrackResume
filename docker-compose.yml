version: '3.8'

services:
  app:
    image: trackresume:latest
    container_name: TrackResume
    restart: unless-stopped
    ports:
      - "53973:3000"
    environment:
      # 数据库配置
      MYSQL_DATABASE_URL: mysql://root:luo123456789@host.docker.internal:52394/cv_dev?connection_limit=5&connect_timeout=60&acquire_timeout=60&timeout=60&pool_timeout=60
      
      # 认证配置
      JWT_SECRET: 2464bvdgk0942595tu05rp34r3n2uh452740u023bi4y5hg94
      NEXTAUTH_URL: http://localhost:3000
      NEXTAUTH_SECRET: sfeagsr2d6gt498trj46ds51fd498saqr4gh9ds2165ae4g978eqt
      
      NEXT_TELEMETRY_DISABLED: 1
    volumes:
      # 挂载环境变量文件
      - ./.env:/app/.env
      # 挂载上传文件目录，分别挂载子目录，避免覆盖整个public
      - ./public/uploads:/app/public/uploads
      - ./public/project:/app/public/project
    extra_hosts:
      - "host.docker.internal:host-gateway"
